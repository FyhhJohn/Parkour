{"version":3,"sources":["Sound.js"],"names":["cc","Class","name","properties","_musicOn","_musicAudioID","_musicName","_effectOn","_effectAudioID","init","sys","localStorage","getItem","playMusic","restart","audioEngine","stop","play","setMusic","on","setItem","playEffect","cb","effectId","setFinishCallback","setEffect","toggleSound","isOn"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,UAAM,OADD;;AAGLC,gBAAY;AACRC,kBAAU,IADF;AAERC,uBAAe,CAFP;AAGRC,oBAAY,EAHJ;;AAKRC,mBAAW,IALH;AAMRC,wBAAgB;AANR,KAHP;;AAYLC,QAZK,kBAYE;AACH,YAAIT,GAAGU,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CAAJ,EAA6C;AACzC,iBAAKR,QAAL,GAAgBJ,GAAGU,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,MAA4C,MAA5D;AACH;AACD,YAAIZ,GAAGU,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAJ,EAA8C;AAC1C,iBAAKL,SAAL,GAAiBP,GAAGU,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,MAA6C,MAA9D;AACH;AACJ,KAnBI;;;AAqBLC,eAAW,mBAAUX,IAAV,EAAgBY,OAAhB,EAAyB;AAChC,YAAIZ,SAAS,EAAT,IAAe,KAAKI,UAAL,KAAoBJ,IAApB,IAA4B,CAACY,OAAhD,EAAyD;AACrD;AACH;AACD,aAAKR,UAAL,GAAkBJ,IAAlB;AACA,YAAI,KAAKE,QAAT,EAAmB;AACfJ,eAAGe,WAAH,CAAeC,IAAf,CAAoB,KAAKX,aAAzB;AACA,iBAAKA,aAAL,GAAqBL,GAAGe,WAAH,CAAeE,IAAf,CAAoB,0CAA0Cf,IAA1C,GAAiD,MAArE,EAA6E,IAA7E,EAAmF,CAAnF,CAArB;AACH;AACJ,KA9BI;;AAgCLgB,cAAU,kBAAUC,EAAV,EAAc;AACpB,aAAKf,QAAL,GAAgBe,EAAhB;AACAnB,WAAGU,GAAH,CAAOC,YAAP,CAAoBS,OAApB,CAA4B,UAA5B,EAAwC,KAAKD,EAA7C;AACA,YAAIA,EAAJ,EAAQ;AACJ,iBAAKN,SAAL,CAAe,KAAKP,UAApB,EAAgC,IAAhC;AACH,SAFD,MAEO;AACHN,eAAGe,WAAH,CAAeC,IAAf,CAAoB,KAAKX,aAAzB;AACH;AACJ,KAxCI;;AA0CLgB,gBAAY,oBAAUnB,IAAV,EAAgBoB,EAAhB,EAAoB;AAC5B,YAAI,KAAKf,SAAT,EAAoB;AAChB;AACA,iBAAKC,cAAL,GAAsBR,GAAGe,WAAH,CAAeE,IAAf,CAAoB,2CAA2Cf,IAA3C,GAAkD,MAAtE,EAA8E,KAA9E,EAAqF,CAArF,CAAtB;AACA,gBAAIqB,WAAW,KAAKf,cAApB;AACA,gBAAIc,EAAJ,EAAQ;AACJtB,mBAAGe,WAAH,CAAeS,iBAAf,CAAiCD,QAAjC,EAA2CD,EAA3C;AACH;AACJ;AACJ,KAnDI;;AAqDLG,eAAW,mBAAUN,EAAV,EAAc;AACrB,aAAKZ,SAAL,GAAiBY,EAAjB;AACAnB,WAAGU,GAAH,CAAOC,YAAP,CAAoBS,OAApB,CAA4B,WAA5B,EAAyC,KAAKD,EAA9C;AACA,YAAI,CAACA,EAAL,EAAS;AACLnB,eAAGe,WAAH,CAAeC,IAAf,CAAoB,KAAKR,cAAzB;AACH;AACJ,KA3DI;;AA6DLkB,eA7DK,yBA6DS;AACV,aAAKR,QAAL,CAAc,CAAC,KAAKX,SAApB;AACA,aAAKkB,SAAL,CAAe,CAAC,KAAKlB,SAArB;AACA,eAAO,KAAKA,SAAZ;AACH,KAjEI;AAmELoB,QAnEK,kBAmEE;AACH,eAAO,KAAKpB,SAAZ;AACH;AArEI,CAAT","file":"Sound.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\core","sourcesContent":["cc.Class({\r\n    name: 'Sound',\r\n\r\n    properties: {\r\n        _musicOn: true,\r\n        _musicAudioID: 0,\r\n        _musicName: '',\r\n\r\n        _effectOn: true,\r\n        _effectAudioID: 0,\r\n    },\r\n\r\n    init() {\r\n        if (cc.sys.localStorage.getItem('MUSIC_ON')) {\r\n            this._musicOn = cc.sys.localStorage.getItem('MUSIC_ON') === 'true';\r\n        }\r\n        if (cc.sys.localStorage.getItem('EFFECT_ON')) {\r\n            this._effectOn = cc.sys.localStorage.getItem('EFFECT_ON') === 'true';\r\n        }\r\n    },\r\n\r\n    playMusic: function (name, restart) {\r\n        if (name === '' || this._musicName === name && !restart) {\r\n            return;\r\n        }\r\n        this._musicName = name;\r\n        if (this._musicOn) {\r\n            cc.audioEngine.stop(this._musicAudioID);\r\n            this._musicAudioID = cc.audioEngine.play('res/raw-assets/resources/sound/music/' + name + '.mp3', true, 1);\r\n        }\r\n    },\r\n\r\n    setMusic: function (on) {\r\n        this._musicOn = on;\r\n        cc.sys.localStorage.setItem('MUSIC_ON', '' + on);\r\n        if (on) {\r\n            this.playMusic(this._musicName, true);\r\n        } else {\r\n            cc.audioEngine.stop(this._musicAudioID);\r\n        }\r\n    },\r\n\r\n    playEffect: function (name, cb) {\r\n        if (this._effectOn) {\r\n            //cc.audioEngine.stop(this._effectAudioID);\r\n            this._effectAudioID = cc.audioEngine.play('res/raw-assets/resources/sound/effect/' + name + '.mp3', false, 1);\r\n            let effectId = this._effectAudioID\r\n            if (cb) {\r\n                cc.audioEngine.setFinishCallback(effectId, cb);\r\n            }\r\n        }\r\n    },\r\n\r\n    setEffect: function (on) {\r\n        this._effectOn = on;\r\n        cc.sys.localStorage.setItem('EFFECT_ON', '' + on);\r\n        if (!on) {\r\n            cc.audioEngine.stop(this._effectAudioID);\r\n        }\r\n    },\r\n\r\n    toggleSound() {\r\n        this.setMusic(!this._effectOn);\r\n        this.setEffect(!this._effectOn);\r\n        return this._effectOn;\r\n    },\r\n\r\n    isOn() {\r\n        return this._effectOn;\r\n    },\r\n});"]}